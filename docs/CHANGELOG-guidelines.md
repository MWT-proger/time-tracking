# Руководство по обновлению CHANGELOG

## Когда обновлять CHANGELOG

**ОБЯЗАТЕЛЬНО** обновлять CHANGELOG при коммитах с изменениями, видимыми пользователю:

✅ **Нужно обновлять:**
- `feat` - новая функциональность
- `fix` - исправление багов
- Изменения в README (важные изменения)
- Изменения в конфигурации, влияющие на пользователя

❌ **НЕ нужно обновлять:**
- `docs` - техническая документация (кроме README)
- `refactor` - рефакторинг без изменения поведения
- `style` - форматирование кода
- `test` - добавление тестов
- `chore` - технические изменения
- `build` - изменения в системе сборки (если не влияют на пользователя)
- `ci` - изменения CI/CD

## Где обновлять

Файл: `docs/CHANGELOG.md`

Всегда обновлять раздел `[Unreleased]` в начале файла.

## Формат записи

### Структура

```markdown
## [Unreleased]

### Добавлено
- Описание новой функции

### Исправлено
- Описание исправления

### Изменено
- Описание изменений в существующей функциональности

### Удалено
- Описание удаленного функционала

### Безопасность
- Описание исправления уязвимости
```

### Правила написания

1. **Используйте императивное наклонение:**
   - ✅ "Добавлена возможность архивирования"
   - ❌ "Добавил возможность архивирования"

2. **Будьте краткими, но информативными:**
   - ✅ "Исправлено зависание таймера при активном отслеживании"
   - ❌ "Исправлена проблема с зависанием таймера при активном отслеживании времени работы"

3. **Для сложных изменений используйте подпункты:**
   ```markdown
   ### Исправлено
   - Исправлено зависание таймера при активном отслеживании времени
     - Добавлена обработка паник в горутине обновления таймера
     - Добавлена защита от гонок данных через sync.RWMutex
     - Добавлено логирование ошибок при проблемах с обновлением заголовка
   ```

4. **Группируйте связанные изменения:**
   ```markdown
   ### Добавлено
   - Создана папка docs для документации проекта
   - Добавлены правила создания коммитов в формате Conventional Commits
   - Добавлен .cursorrules с инструкциями для AI-ассистента
   ```

## Примеры

### Пример 1: Новая функция

**Коммит:**
```
feat: добавлена возможность архивирования проектов
```

**CHANGELOG:**
```markdown
## [Unreleased]

### Добавлено
- Добавлена возможность архивирования проектов
- Добавлена возможность восстановления проектов из архива
```

### Пример 2: Исправление бага

**Коммит:**
```
fix(systray): исправлено зависание таймера при активном отслеживании
```

**CHANGELOG:**
```markdown
## [Unreleased]

### Исправлено
- Исправлено зависание таймера в системном трее при активном отслеживании времени
  - Добавлена обработка паник в горутине обновления таймера
  - Добавлена защита от гонок данных через sync.RWMutex
  - Добавлено логирование ошибок при проблемах с обновлением заголовка
```

### Пример 3: Комбинированный коммит

**Коммит:**
```
build: добавлена автоматизация сборки и релизов

- ci: добавлен GitHub Actions workflow
- build: улучшена система сборки DEB пакетов
- docs: расширена документация по установке
```

**CHANGELOG:**
```markdown
## [Unreleased]

### Добавлено
- Добавлен автоматический процесс сборки и создания релизов через GitHub Actions
- Расширена документация по установке с инструкциями для разных дистрибутивов
```

## Процесс работы

1. Внести изменения в код
2. Определить тип коммита
3. Если это `feat` или `fix` - обновить CHANGELOG
4. Добавить CHANGELOG в staging: `git add docs/CHANGELOG.md`
5. Создать коммит

## Проверка перед коммитом

Перед созданием коммита убедитесь:

- [ ] CHANGELOG обновлен (если требуется)
- [ ] Запись в CHANGELOG соответствует изменениям
- [ ] Используется правильный подраздел
- [ ] Текст написан в императивном наклонении
- [ ] CHANGELOG добавлен в staging

## При создании релиза

При создании нового релиза (тег версии):

1. Переместить записи из `[Unreleased]` в новый раздел с версией
2. Добавить дату релиза
3. Обновить ссылки внизу файла
4. Оставить пустой раздел `[Unreleased]` для следующих изменений

Пример:
```markdown
## [Unreleased]

## [0.9.1] - 2025-10-31

### Исправлено
- Исправлено зависание таймера при активном отслеживании
```

